define(["./css.api","require"],function(c,k){var d={add:function(){return c.add.apply(c,arguments)},clear:function(){return c.clear.apply(c,arguments)},normalize:function(b,a){return"!"==b.substr(b.length-1,1)?a(b.substr(0,b.length-1))+"!":a(b)},escape:function(b){return b.replace(/(["'\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},load:function(b,a,c,f){d.config=d.config||f;c()},write:function(b,a,h){if(">>"!=a.substr(0,
2)){var f="!"==a.substr(a.length-1,1);fileName=f?a.substr(0,a.length-1):a;var i;var j=k.toUrl(fileName+".css");if("undefined"!==typeof process&&process.versions&&process.versions.node&&require.nodeRequire){var e=require.nodeRequire("fs").readFileSync(j,"utf8");i=0===e.indexOf("\ufeff")?e.substring(1):e}else{var e=new java.io.File(j),j=java.lang.System.getProperty("line.separator"),e=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(e),"utf-8")),g;try{i=new java.lang.StringBuffer;
(g=e.readLine())&&(g.length()&&65279===g.charAt(0))&&(g=g.substring(1));for(i.append(g);null!==(g=e.readLine());)i.append(j),i.append(g)}finally{e.close()}i=void 0}c.add(i,fileName,f);h.asModule(b+"!"+a,"define(function(){})")}else if(">>"==a.substr(0,2))d.onLayerComplete(a.substr(2),h)},onLayerComplete:function(b,a){d.writeScriptBuffer(a);if(d.config.separateCSS&&""!=c.buffer){var h=d.config.dir?d.config.dir+b+".css":d.config.out.replace(/\.js$/,".css");"undefined"!=typeof console&&console.log&&
console.log("Writing CSS! file: "+b+"\n");var f;f=c.convertStyleBase(c.buffer,require.toUrl("."),h);if(""!=f)if("undefined"!==typeof process&&process.versions&&process.versions.node&&require.nodeRequire)require.nodeRequire("fs").writeFileSync(h,f,"utf8");else throw h=new java.io.File(url),java.lang.System.getProperty("line.separator"),new java.io.BufferedWriter(new java.io.OutputStreamWriter(new java.io.FileOutputStream(h),"utf-8")),"Rhino support for require-css isn't complete...";}c.clear()},writeScriptBuffer:function(b){var a;
a=d.escape(d.config.separateCSS?c.scriptBuffer:c.buffer+c.scriptBuffer);""!=a&&b("require(['css'], function(css) {\n  css.add(\""+a+'");\n})')}};return d});